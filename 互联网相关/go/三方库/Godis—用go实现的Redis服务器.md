### 背景

自从工作以来，在编码过程中用到的中间件组件比较少，Redis也是一直想学的缓存数据库；但是因为个人原因一直没有学，在2022年初的时候学习go，并发现go语言相对于其他语言更轻量，编写代码也更方便，性能更加强大。

在决定深入学习go的时候，需要一个项目来深入go的各种语法以及代码风格，摒弃掉Java的编码风格。有了2个需求，在逛 `HelloGithub` 网站Go语言项目专题时，看到了这个项目，就决定fork项目下来阅读源码，在学习 `Redis` 相关知识时也深入学习Go的进阶知识。



### Godis简介

```
Godis 是一个用 Go 语言实现的 Redis 服务器。本项目旨在为尝试使用 Go 语言开发高并发中间件的朋友提供一些参考。

关键功能:
- 支持 string, list, hash, set, sorted set, bitmap 数据结构
- 自动过期功能(TTL)
- 发布订阅
- 地理位置
- AOF 持久化及 AOF 重写
- 加载和导出 RDB 文件
- Multi 命令开启的事务具有`原子性`和`隔离性`. 若在执行过程中遇到错误, godis 会回滚已执行的命令
- 内置集群模式. 集群对客户端是透明的, 您可以像使用单机版 redis 一样使用 godis 集群
  - `MSET`, `MSETNX`, `DEL`, `Rename`, `RenameNX`  命令在集群模式下原子性执行, 允许 key 在集群的不同节点上
  - Multi 命令开启的事务在集群模式下支持在同一个 slot 内执行
- 并行引擎, 无需担心您的操作会阻塞整个服务器.
```

> 摘抄自 `Godis` 的 `README_CN.md` 文件

在阅读一个项目源码时（其实不只是源码，可以是现实中任意一个想要学习的目标事物），需要确认自己对于这个事物所了解的点、通过这个事物自己想知道一些什么、通过什么方式去学习这个事物以及最后自己学到了什么；

针对以上的点，可以使用 `KWHL` 图表来辅助学习
![](https://images-1306554305.cos.ap-guangzhou.myqcloud.com/202206132057355.png)

在思维导图的 `W(我想知道些什么)` 一栏中的知识点是我在看到 `Godis` 这个项目后所得的疑问以及想要的知识点中，可以根据知识点的特性分类，分别是 **TCP服务**、**数据结构以及命令实现**、**集群实现以及AOF持久化**；

下面我就从main函数开始阅读源代码。


### 运行代码
将  [`Godis`](https://github.com/HDT3213/godis) 项目代码通过 `git` 克隆到本地

**下载依赖**
进入到克隆的代码目录中执行以下命令：
```bash
go mod tidy
```



### 阅读源码

#### TCP服务端部分

在服务端服务


